---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}

#get data
faostat=read.csv("https://github.com/howlem/projectData/raw/master/Production_Crops_E_All_Data.csv",stringsAsFactors = F)

#check is data frame
is.data.frame(faostat)

```

```{r}
#install libraries needed later
library(DescTools)
library(ggplot2)
library(moments)
library(stringr)
library(scales)


#review data called
head(faostat)
str(faostat)
names(faostat)
```

```{r}
##YIELD##
#just keep yield data
yield_1=faostat[faostat$'Element'!='Production',]
yield=yield_1[yield_1$'Element'!='Area harvested',]
head(yield)

#aggregate by country
yield=aggregate(yield$'Y2016',by=list(yield$'Area'),sum)
names(yield)=c('country','TotYield2016')
yield

str(yield)

##PRODUCTION##
#just keep production data
prod_1=faostat[faostat$'Element'!='Yield',]
prod=prod_1[prod_1$'Element'!='Area harvested',]
head(prod)

#aggregate by country
prod=aggregate(prod$'Y2016',by=list(prod$'Area'),sum)
names(prod)=c('country','TotProd2016')
prod

##AREA HARVESTED##
#just keep area harvested data
area_harv_1=faostat[faostat$'Element'!='Yield',]
area_harv=area_harv_1[area_harv_1$'Element'!='Production',]
head(area_harv)

#aggregate by country
area_harv=aggregate(area_harv$'Y2016',by=list(area_harv$'Area'),sum)
names(area_harv)=c('country','TotAreaHarv2016')
area_harv
```


```{r}

#UNIVARIATE ANALYSIS

#check data types
str(yield)

#centrality
summary(yield$'TotYield2016')

#dispersion
sd(yield$'TotYield2016',na.rm=T)

##coefficient of variation
sd(yield$'TotYield2016',na.rm=T)/mean(yield$'TotYield2016',na.rm=T)

#skewness
skewness(yield$'TotYield2016',na.rm=T)

#kurtosis
kurtosis(yield$'TotYield2016',na.rm=T)
Kurt(yield$'TotYield2016',na.rm=T)

#histogram
##keep non missing
data=yield[is.finite(yield$'TotYield2016'),]

##making numeric
as.numeric(data$'TotYield2016')

##histogram
hist(data$'TotYield2016')

##histogram of log
hist(log(data$'TotYield2016'))

#saving mean and sd
mnVar=mean(var,na.rm=T)
sdVar=sd(var,na.rm=T)

# ##select a var
# var=data$'TotYield2016'

# ##plotting
# base=ggplot(data,aes(x=var))
# hist=base + geom_histogram(fill="green",
#                          color='grey',
#                          aes(y=..density..))
# 
# histAndNormal=hist + stat_function(fun=dnorm,
#                                    color="red",
#                                    args=list(mean=mnVar,sd=sdVar))
# 
# histAndNormal

#outliers
summary(yield$'TotYield2016')

##boxplot
(bp=boxplot(yield$'TotYield2016',horizontal=T))

##boxplot of log
(bp_log=boxplot(log(yield$'TotYield2016')))

bp$stats
bp_log$stats

length(bp_log$out)

```

```{r}
##BIVARIATE ANALYSIS

#merge yield, production, and area harvested data into one dataset
combinedYP=merge(yield,prod)
combinedYPAH=merge(combined,area_harv)
head(combinedYPAH)

#correlation
res<-cor(combinedYPAH[,c(2:4)],use='complete.obs')
round(res,2)

#correlation of log
res_log<-cor(log(combinedYPAH[,c(2:4)]),use='complete.obs')
round(res_log,2)

#scatterplot
library(car)
scatterplotMatrix(combinedYPAH[,c(2:4)],
                  main="Simple Scatterplot Matrix")

#scatterplot of log
scatterplotMatrix(log(combinedYPAH[,c(2:4)]),
                  main="Simple Scatterplot Matrix")

#non-parametric
cor(combinedYPAH[,c(2:4)],use='complete.obs',method='spearman')

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
